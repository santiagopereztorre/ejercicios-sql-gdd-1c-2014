-- Realizar una consulta que muestre código de artículo, detalle y cantidad de egresos 
-- de stock que se realizaron para ese artículo en el año 2012 (egresan los productos 
-- que fueron vendidos). Mostrar solo aquellos que hayan tenido más egresos que en el 
-- 2011. SELECT prod_codigo, prod_detalleFROM dbo.Item_Factura	INNER JOIN dbo.Factura ON item_tipo = fact_tipo AND item_sucursal = fact_sucursal AND item_numero = fact_numero	INNER JOIN dbo.Producto ON item_producto = prod_codigoWHERE DATEPART(year, fact_fecha) = 2012	AND	(		(SELECT SUM(i2.item_cantidad) 		FROM dbo.Item_Factura i2			INNER JOIN dbo.Factura f2 ON item_tipo = fact_tipo AND item_sucursal = fact_sucursal AND item_numero = fact_numero		WHERE DATEPART(year, f2.fact_fecha) = 2012 AND i2.item_producto = prod_codigo)		>		(SELECT SUM(i2.item_cantidad) 		FROM dbo.Item_Factura i2			INNER JOIN dbo.Factura f2 ON item_tipo = fact_tipo AND item_sucursal = fact_sucursal AND item_numero = fact_numero		WHERE DATEPART(year, f2.fact_fecha) = 2011 AND i2.item_producto = prod_codigo)		)GROUP BY prod_codigo, prod_detalle